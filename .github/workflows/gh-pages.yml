name: Deploy React App to GitHub Pages # Action çš„åç§°
permissions:
  contents: write

on:
  push:
    branches:
      - master # å½“ä»£ç æ¨é€åˆ° main åˆ†æ”¯æ—¶è§¦å‘æ­¤ Action

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # åœ¨æœ€æ–°çš„ Ubuntu è¿è¡Œå™¨ä¸Šæ‰§è¡Œä»»åŠ¡
    
    steps:
      - name: â¬‡ï¸ Checkout Repository
        uses: actions/checkout@v4 # æ£€å‡ºä»“åº“ä»£ç 
      
      # --- Node.js ç¯å¢ƒè®¾ç½® ---
      - name: âš™ï¸ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # æŒ‡å®š Node.js ç‰ˆæœ¬ï¼Œå»ºè®®ä½¿ç”¨ LTS ç‰ˆæœ¬
          cache: 'npm' # æˆ– 'yarn'ï¼Œå–å†³äºä½ ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨

      # --- å®‰è£…ä¾èµ– ---
      - name: ğŸ“¦ Install Dependencies
        run: npm install # æˆ– 'yarn install'

      # --- æ„å»º React åº”ç”¨ ---
      - name: ğŸ”¨ Build React Application
        run: npm run build # æˆ– 'yarn build'
        env:
          CI: false # é¿å…åœ¨æ„å»ºè¿‡ç¨‹ä¸­å›  warnings è¢«è§†ä¸º errors
          VITE_BASE_URL: /msgpack-visualizer/ # è®¾ç½®åŸºç¡€è·¯å¾„ä»¥åŒ¹é… GitHub Pages çš„å­è·¯å¾„
      
      # --- éƒ¨ç½²åˆ° GitHub Pages ---
      # ä½¿ç”¨ peaceiris/actions-gh-pages è¿™ä¸ªæµè¡Œçš„ Action è¿›è¡Œéƒ¨ç½²
      - name: ğŸš€ Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }} # GitHub æä¾›çš„é»˜è®¤ token
          publish_dir: ./dist # æŒ‡å®šè¦éƒ¨ç½²çš„æ„å»ºç›®å½• (é»˜è®¤æ˜¯ 'build')
          # é»˜è®¤éƒ¨ç½²åˆ° 'gh-pages' åˆ†æ”¯ï¼ŒGitHub Pages ä¼šä»è¿™ä¸ªåˆ†æ”¯æä¾›æœåŠ¡
          # publish_branch: gh-pages